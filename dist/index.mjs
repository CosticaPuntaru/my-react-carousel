import e,{useEffect as n}from"react";var t=function(){return(t=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)};function o(e,n,t){if(t||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}var r="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),i=e.forwardRef((function(i,u){var c=i.slidesToShow,a=void 0===c?3:c,l=i.infinite,s=void 0===l||l,f=i.transitionDuration,d=void 0===f?300:f,h=i.centerCurrentSlide,v=void 0!==h&&h,p=i.render,g=void 0===p?function(e){return e.slides}:p,T=i.onCurrentSlideChanged,m=function(n,t){var r=t.infinite,i=t.slidesToShow,u=t.mode,c=void 0===u?"flex":u;return e.useMemo((function(){var t=e.Children.toArray(n),u=t.length,a=r?t.slice(u-(i+2)):[],l=r?t.slice(0,i+2):[];return"flex"===c?{slides:o(o(o([],a,!0),t,!0),l,!0).map((function(n,t){return e.cloneElement(n,{style:{flex:"0 0 ".concat(100/i,"%")},key:t})})),slideCount:u,preSlidesCount:a.length}:{slides:o(o(o([],a,!0),t,!0),l,!0).map((function(n,t){return e.cloneElement(n,{key:t})})),slideCount:u,preSlidesCount:a.length}}),[n,r,i])}(i.children,{infinite:s,slidesToShow:a,mode:"flex"}),w=m.slides,S=m.slideCount,C=m.preSlidesCount,x=function(n){var t=n.infinite,o=n.slidesToShow,r=n.slideCount,i=e.useState(0),u=i[0],c=i[1];return{previous:e.useCallback((function(){return c((function(e){return t||e-1>=0?e-1:0}))}),[t]),next:e.useCallback((function(){return c((function(e){return t||e+1<r-o?e+1:r-o}))}),[t,r,o]),hasNext:!!t||u+o<r,hasPrevious:!!t||u>0,currentIndex:u,currentStep:u>=r?u-r:u<0?u+r:u,totalSteps:t?r:1+r-o,goToStep:c}}({infinite:s,slidesToShow:a,slideCount:S}),y=x.previous,b=x.next,M=x.goToStep,k=x.currentIndex;n((function(){"function"==typeof T&&T(k)}),[k]),e.useImperativeHandle(u,(function(){return{previous:y,next:b,goToStep:M}}),[y,b]);var E=e.useRef(null),A=e.useState(0),R=A[0],P=A[1],D=e.useState(!1),L=D[0],O=D[1];!function(n){var t=n.wrapper,o=n.callback,r=n.measure,i=n.slidesToShow,u=n.mode,c=void 0===u?"flex":u,a=e.useCallback((function(){return requestAnimationFrame((function(){if(t.current)if("flex"===c){var e=t.current.getBoundingClientRect();o(Math.round(e[r]/i))}else if("fixed"===c){var n=t.current.children[0];n.children.length>0&&(e=n.children[0].getBoundingClientRect(),o(e[r]))}}))}),[i,o]);e.useLayoutEffect((function(){return a(),window.addEventListener("resize",a),function(){return window.removeEventListener("resize",a)}}))}({wrapper:E,callback:function(e){R!==e&&(O(!0),P(e))},slidesToShow:a,measure:"width",mode:"flex"}),e.useEffect((function(){L?k<0||k>=S?requestAnimationFrame((function(){return x.goToStep((function(e){return e<0?s?S+e:0:e-S}))})):requestAnimationFrame((function(){return O(!1)})):(k>=S||k<0)&&setTimeout((function(){return O(!0)}),d)}),[L,k,S,d]);var X=function(n){var t=e.useRef(!1),o=e.useRef(null),i=e.useRef(null),u=e.useState(0),c=u[0],a=u[1],l=function(){setTimeout((function(){return a(0)}),0),o.current=null,i.current=null,t.current=!1};e.useEffect((function(){if(r){var e=function(e){1===e.touches.length&&t.current&&(e.cancelable?e.preventDefault():l())};return document.addEventListener("touchmove",e,{passive:!1}),function(){document.removeEventListener("touchmove",e)}}}),[]);var s=e.useCallback((function(e){if(e.changedTouches&&e.changedTouches.length>1)return null;var n=e.changedTouches?e.changedTouches[0].clientY:e.clientY;o.current=e.changedTouches?e.changedTouches[0].clientX:e.clientX,i.current=n}),[]),f=e.useCallback((function(e){if(null!==o.current){e.changedTouches&&e.changedTouches.length>1&&l();var n=(e.changedTouches?e.changedTouches[0].clientX:e.clientX)-o.current,u=(e.changedTouches?e.changedTouches[0].clientY:e.clientY)-i.current;a(n),r&&t.current&&e.stopPropagation(),t.current||(Math.abs(u)>10*window.devicePixelRatio?l():Math.abs(n)>5*window.devicePixelRatio&&(t.current=!0))}}),[o]),d=e.useCallback((function(){n(c),l()}),[c,n]),h=e.useCallback((function(e){Math.abs(c)>5&&(e.preventDefault(),e.stopPropagation())}),[c]);return{isTouching:null!==o.current,touchOffset:c,onTouchStart:s,onTouchMove:f,onTouchEnd:d,onClickCapture:h}}(e.useCallback((function(e){var n=Math.round((e>0?e+.3*R:e-.3*R)/R);if(s)x.goToStep((function(e){return e-n}));else{if(0===n)return;x.goToStep((function(e){return e-n>S-a?S-a:e-n<0?0:e-n}))}}),[R,S,a,x.goToStep])),Y=X.onTouchStart,q=X.onTouchMove,z=X.onTouchEnd,F=X.onClickCapture,I=X.touchOffset-(k+C)*R+(v?(a/2-.5)*R:0),j=L||X.isTouching?0:d,B=100/a*-(k+C)+(v?100/a*(a/2-.5):0);return g(t(t({},x),{slides:e.createElement("div",{style:{width:"100%",overflow:"hidden"},ref:E},e.createElement("div",{onTouchStart:Y,onTouchMove:q,onTouchEnd:z,onMouseDown:Y,onMouseMove:q,onMouseUp:z,onMouseLeave:z,onClickCapture:F,style:{display:"flex",flexDirection:"row",transform:"translateX(".concat(R?"".concat(I,"px"):"".concat(B,"%"),")"),transition:"transform ".concat(j,"ms ease"),touchAction:"pan-y pinch-zoom"}},w)),slidesToShow:a,infinite:s,transitionDuration:d,centerCurrentSlide:v}))}));function u(e){return function(n){var o=n.currentStep,r=n.totalSteps,i=n.goToStep,u=n.infinite,c=Array.from(Array(r)).map((function(e,n){return{index:n,onClick:function(){return i(u?(e=o,a=(t=n)+(c=r),l=t-c,s=Math.abs(a-e),f=Math.abs(e-l),s<(d=Math.abs(t-e))?a:f<d?l:t):n);var e,t,c,a,l,s,f,d},isActive:n===o}}));return e(t({dots:c},n))}}export default i;export{u as generateDots};
