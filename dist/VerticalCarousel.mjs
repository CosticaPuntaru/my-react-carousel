import e,{useEffect as n}from"react";var t=function(){return(t=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function r(e,n,t){if(t||2===arguments.length)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))}var i=e.forwardRef((function(i,o){var u=i.slidesToShow,l=void 0===u?3:u,s=i.infinite,a=void 0===s||s,c=i.transitionDuration,f=void 0===c?300:c,d=i.render,h=void 0===d?function(e){return e.slides}:d,p=i.onCurrentSlideChanged,v=function(n,t){var i=t.infinite,o=t.slidesToShow,u=t.mode,l=void 0===u?"flex":u;return e.useMemo((function(){var t=e.Children.toArray(n),u=t.length,s=i?t.slice(u-(o+2)):[],a=i?t.slice(0,o+2):[];return"flex"===l?{slides:r(r(r([],s,!0),t,!0),a,!0).map((function(n,t){return e.cloneElement(n,{style:{flex:"0 0 ".concat(100/o,"%")},key:t})})),slideCount:u,preSlidesCount:s.length}:{slides:r(r(r([],s,!0),t,!0),a,!0).map((function(n,t){return e.cloneElement(n,{key:t})})),slideCount:u,preSlidesCount:s.length}}),[n,i,o])}(i.children,{infinite:a,slidesToShow:l,mode:"flex"}),m=v.slides,S=v.slideCount,g=v.preSlidesCount,w=function(n){var t=n.infinite,r=n.slidesToShow,i=n.slideCount,o=e.useState(0),u=o[0],l=o[1];return{previous:e.useCallback((function(){return l((function(e){return t||e-1>=0?e-1:0}))}),[t]),next:e.useCallback((function(){return l((function(e){return t||e+1<i-r?e+1:i-r}))}),[t,i,r]),hasNext:!!t||u+r<i,hasPrevious:!!t||u>0,currentIndex:u,currentStep:u>=i?u-i:u<0?u+i:u,totalSteps:t?i:1+i-r,goToStep:l}}({infinite:a,slidesToShow:l,slideCount:S}),x=w.previous,y=w.next,C=w.goToStep,T=w.currentIndex;n((function(){"function"==typeof p&&p(T)}),[T]),e.useImperativeHandle(o,(function(){return{previous:x,next:y,goToStep:C}}),[x,y]);var E=e.useRef(null),b=e.useState(0),k=b[0],A=b[1],R=e.useState(!1),q=R[0],D=R[1];!function(n){var t=n.wrapper,r=n.callback,i=n.measure,o=n.slidesToShow,u=n.mode,l=void 0===u?"flex":u,s=e.useCallback((function(){return requestAnimationFrame((function(){if(t.current)if("flex"===l){var e=t.current.getBoundingClientRect();r(Math.round(e[i]/o))}else if("fixed"===l){var n=t.current.children[0];n.children.length>0&&(e=n.children[0].getBoundingClientRect(),r(e[i]))}}))}),[o,r]);e.useLayoutEffect((function(){return s(),window.addEventListener("resize",s),function(){return window.removeEventListener("resize",s)}}))}({wrapper:E,callback:function(e){k!==e&&(D(!0),A(e))},slidesToShow:l,measure:"height",mode:"flex"}),e.useEffect((function(){q?T<0||T>=S?requestAnimationFrame((function(){return w.goToStep((function(e){return e<0?a?S+e:0:e-S}))})):requestAnimationFrame((function(){return D(!1)})):(T>=S||T<0)&&setTimeout((function(){return D(!0)}),f)}),[q,T,S,f]);var F=100/l*-(T+g),I=q||f;return h(t(t({},w),{slides:e.createElement("div",{style:{width:"auto",height:"100%",overflow:"hidden"},ref:E},e.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",transform:"translateY(".concat(F,"%)"),transition:"transform ".concat(I,"ms ease")}},m)),slidesToShow:l,infinite:a,transitionDuration:f}))}));export default i;
